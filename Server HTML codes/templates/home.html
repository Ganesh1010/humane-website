{% load static%}
<!DOCTYPE html>
<html lang="en">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<script src="{% static "assests/JS/humane.js"%}"></script>
	<script src="{% static "assests/JS/donation.js"%}"></script>
	<link rel="stylesheet" href="{% static "assests/CSS/humane.css"%}">
	<style>
		.loader {
			position: fixed;
			left: 0px;
			top: 0px;
			width: 100%;
			height: 100%;
			z-index: 9999;
			background: url('https://loading.io/assets/img/landing/curved-bars.svg') 50% 50% no-repeat rgb(249, 249, 249);
			opacity: .8;
		}
	</style>
</head>

<body>
	<div id="main">
		<div class="container">
			<div class="row ">
				<div class="col-md-12 ">
					<div class="panel with-nav-tabs panel-info">
						<div class="panel-heading">
							<ul class="nav nav-tabs">
								<li class="active col-sm-2"><a href="#goodstab" data-toggle="tab" id="goods-anchor">Goods</a></li>
								<li class="col-sm-2"><a href="#servicetab" data-toggle="tab" id="service-anchor">Services</a></li>
							</ul>
						</div>
						<div class="panel-body ">
							<div class="tab-content ">

								<div class="tab-pane fade in active" id="goodstab">
									<div class="loader" id="goods-loader"></div>
								</div>


								<div class="tab-pane fade " id="servicetab">
									<div class="loader" id="service-loader"></div>
								</div>

							</div>
						</div>
						<div class="panel-footer text-center">
							<div id="goods-pagination"></div>
							<div id="service-pagination"></div>

						</div>

					</div>

					<div class="modal fade" id="myModal" role="dialog">
						<div class="modal-dialog">

							<!-- Modal content-->
							<div class="modal-content">
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal">&times;</button>
									<h4 class="modal-title">Need Details</h4>
								</div>

								<div class="modal-body">
									<div class="container">
										<div class="row">
											<div class="col-md-6">
												<table class="table table-hover">
													<thead>
														<tr>
															<th>Product</th>
															<th class="text-center">Required (Kg)</th>
															<th class="text-center">Received (Kg)</th>
															<th class="text-center">Your Contribution (Kg)</th>
															<th> </th>
														</tr>
													</thead>
													<tbody>
														<tr>
															<td class="col-md-6">
																<div class="media">
																	<a class="thumbnail pull-left" href="#"> <img class="media-object" src="images/rice.jpg" style="width:100%; height:100%;"> </a>
																	<div class="media-body">
																		<h4 class="media-heading"><a href="#">Product name</a></h4>
																		<h5 class="media-heading"> by <a href="#">Brand name</a></h5>
																		<span>Status: </span><span class="text-success"><strong>10+ Promised</strong></span>
																	</div>
																</div>
															</td>
															<td class="col-sm-1 col-md-1 text-center"><strong>10</strong></td>
															<td class="col-sm-1 col-md-1 text-center"><strong>5</strong></td>
															<td class="col-sm-1 col-md-1" style="text-align: center">
																<div class="input-group">
																	<span class="input-group-btn">
											  <button type="button" class="btn btn-danger btn-number"  data-type="minus" data-field="quant[2]">
												<span class="glyphicon glyphicon-minus"></span>
																	</button>
																	</span>
																	<input type="text" name="quant[2]" class="form-control input-number" value="0" min="1" max="100">
																	<span class="input-group-btn">
											  <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="quant[2]">
												  <span class="glyphicon glyphicon-plus"></span>
																	</button>
																	</span>
																</div>
															</td>

														</tr>
														<tr>
															<td class="col-md-6">
																<div class="media">
																	<a class="thumbnail pull-left" href="#"> <img class="media-object" src="images/pulses.jpg" style="panel-heading"> </a>
																	<div class="media-body">
																		<h4 class="media-heading"><a href="#">Rice</a></h4>
																		<h5 class="media-heading"> by <a href="#">Vuram</a></h5>
																		<span>Status: </span><span class="text-warning"><strong>No Promises</strong></span>
																	</div>
																</div>
															</td>
															<td class="col-sm-1 col-md-1 text-center"><strong>10</strong></td>
															<td class="col-sm-1 col-md-1 text-center"><strong>5</strong></td>
															<td class="col-sm-1 col-md-1" style="text-align: center">
																<div class="input-group">
																	<span class="input-group-btn">
											  <button type="button" class="btn btn-danger btn-number"  data-type="minus" data-field="quant[2]">
												<span class="glyphicon glyphicon-minus"></span>
																	</button>
																	</span>
																	<input type="text" name="quant[2]" class="form-control input-number" value="0" min="1" max="100">
																	<span class="input-group-btn">
											  <button type="button" class="btn btn-success btn-number" data-type="plus" data-field="quant[2]">
												  <span class="glyphicon glyphicon-plus"></span>
																	</button>
																	</span>
																</div>
															</td>

														</tr>
														<tr>
															<td>   </td>
															<td>   </td>
															<td>
																<button type="button" class="btn btn-default" data-dismiss="modal">
										<span class="glyphicon glyphicon-shopping-cart"></span> Cancel
									</button></td>
															<td>
																<button type="button" class="btn btn-success" data-dismiss="modal">
										Donate <span class="glyphicon glyphicon-play"></span>
									</button></td>
														</tr>
													</tbody>
												</table>
											</div>
										</div>
									</div>
								</div>

							</div>
						</div>

					</div>

					<div class="modal fade" id="New_Goods_Modal" role="dialog">
						<div class="modal-dialog">

							<!-- Modal content-->
							<div class="modal-content">

								<!-- Modal header-->
								<div class="modal-header">
									<button type="button" class="close" data-dismiss="modal">&times;</button>
									<h4 class="modal-title">New Need</h4>
								</div>

								<!-- Modal Body-->
								<div class="modal-body">
									<div class="container">
										<div class="row">
											<div class="col-md-6">
												<form>
													<table>
														<thead>
															<tr>
																<td>Main Item: </td>
																<td class="text-center"></td>
															</tr>
														</thead>
														<tbody>
															<tr>
																<td class="col-sm-1 col-md-1 text-center">
																	<select class="form-control" id="count">
																<option>Select Main Item</option>
																<option>Cloth</option>
																<option>Groceries</option>
																<option>Stationaries</option>
															</select>
																</td>
																<td class="col-sm-1 col-md-1 text-center">
																	<button class="btn btn-primary">Add New Item</buuton>
														</td>
													</tr>
												</tbody>
											</table>
											<br><br>
											<table class="table table-hover">
												<thead>
													<tr>
														<th>Sub Item</th>
														<th class="text-center">Quantity (Kg)</th>
													</tr>
												</thead>
												<tbody>
													<tr>
														<td class="col-sm-1 col-md-1 text-center">
															<select class="form-control" id="count">
																<option>Select Sub Item</option>
																<option>Rice</option>
																<option>Wheat</option>
																<option>Sugar</option>
																<option>Salt</option>
																<option>Pulses</option>
															</select>
														</td>
														<td class="col-sm-1 col-md-1 text-center">
															<div class="input-group">
																<span class="input-group-btn">
																	<button type="button" class="btn btn-danger btn-number"  data-type="minus" data-field="quant[2]">
																		<span class="glyphicon glyphicon-minus"></span>
																	</button>
																	</span>
																	<input type="text" id="quantity1" name="quantity1" class="form-control input-number" value="0" min="1" max="100">
																	<span class="input-group-btn">
																	<button type="button" class="btn btn-success btn-number" data-type="plus" data-field="quant[2]">
																		<span class="glyphicon glyphicon-plus"></span>
																	</button>
																	</span>
											</div>
											</td>
											</tr>
											<tr>
												<td></td>
												<td class="pull-right">
													<button type="button" class="btn btn-default" data-dismiss="modal">
															<span class="glyphicon glyphicon-shopping-cart"></span> Cancel
														</button>
													<button type="button" class="btn btn-success" data-dismiss="modal">
															Request <span class="glyphicon glyphicon-play"></span>
														</button></td>
											</tr>
											</tbody>
											</table>
											</form>
										</div>
									</div>
								</div>
							</div>

							<!-- Modal footer-->

						</div>
					</div>
				</div>

			</div>
		</div>
	</div>
	</div>
</body>
<script type="text/javascript">
	$(document).ready(function() {
		var firstServiceLoad = true;
		var goodsDetailURL = "/humane/goodsDetail/?isweb=True&callback=?";
		var serviceDetailURL = "/humane/serviceDetail/?isweb=True&callback=?";

		loadGoodsDetail(goodsDetailURL);

		$("#service-anchor").click(function(e) {
		console.log("firstServiceLoad"+firstServiceLoad)
			if (firstServiceLoad) {
				loadServiceDetail(serviceDetailURL);
				firstServiceLoad = false;
			}
			$('#service-pagination').show();
			$('#goods-pagination').hide();

		});

		$("#goods-anchor").click(function(e) {
			$('#service-pagination').hide();
			$('#goods-pagination').show();
		});

		
		function loadGoodsDetail(goodsDetailURL) {
			$.getJSON(goodsDetailURL, function(data) {})
				.done(function(data) {
					
					var count = $.parseJSON(data)['count']
					console.log("goods count " + parseInt(count))
					if (parseInt(count) != 0)
						getGoodsdetail(data);
					else{
					$('.loader').hide();
						document.getElementById("goodstab").innerHTML = "No Goods Found";
						}
					if (parseInt(count) > 10)
						createPagination(count, goodsDetailURL, "goods-pagination", "#goodstab", 1);
				})
				.fail(function() {
					console.log("error");
				})
				.always(function() {
					console.log("goods detail load complete");
				});
		}
		function VerifyInput(input){
    for(var x=0; x<input.length; ++x){
        let c = input.charCodeAt(x);
        if(c >= 0 && c <= 31){
            throw 'problematic character found at position ' + x +c;
        }
    }
}		
		function loadServiceDetail(serviceDetailURL) {
		console.log("service url called");
		$('.loader').show();
			$.getJSON(serviceDetailURL, function(data) {})
				.done(function(serviceData) {
				//console.log(VerifyInput(serviceData));
					
					var count = $.parseJSON(serviceData)['count']
					console.log("service count " + count)
					if (parseInt(count) != 0)
						getServiceDetail(serviceData);
					else{
					$('.loader').hide();
						document.getElementById("servicetab").innerHTML = "No Service Found";
						}
					if (count > 10)
						createPagination(count, serviceDetailURL, "service-pagination", "#servicetab", 2);
				})
				.fail(function() {
					console.log("error");
				})
				.always(function() {
					console.log("service detail load complete");
				});
		}
	});
</script>

</html>